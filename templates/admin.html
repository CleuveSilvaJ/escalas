<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>√Årea do Coordenador - Pastoral da Acolhida</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="icon" href="/static/favicon.png" type="image/png">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

  <style>
    /* ===== CAMPO DE AVISO ===== */
    .aviso-texto {
      min-height: 70px;
      resize: vertical;
      font-size: 1rem;
    }

    /* ===== AJUSTE MOBILE ===== */
    @media (max-width: 768px) {

      table thead {
        display: none;
      }

      table, tbody, tr, td {
        display: block;
        width: 100%;
      }

      tr {
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 0.8rem;
        margin-bottom: 1rem;
        background: #fff;
      }

      td {
        border: none;
        padding: 0.4rem 0;
      }

      .td-data {
        font-weight: bold;
        font-size: 1.1rem;
        margin-bottom: 0.4rem;
      }

      .aviso-texto {
        width: 100%;
        min-height: 120px;
        font-size: 1.1rem;
      }

      .acoes {
        display: flex;
        gap: 0.5rem;
        margin-top: 0.6rem;
      }

      .acoes button {
        flex: 1;
      }
    }
  </style>
</head>

<body class="bg-light">

<div class="container mt-4">

  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3>√Årea do Coordenador</h3>
    <a href="{{ url_for('logout') }}" class="btn btn-secondary btn-sm">Sair</a>
  </div>

  <!-- Mensagens -->
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="alert alert-{{ category }}">
          {{ message }}
        </div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  {% for semana in semanas %}

    <h5 class="mt-4 mb-2">üìÖ {{ semana.titulo }}</h5>

    <div class="table-responsive">
      <table class="table table-bordered bg-white align-middle">
        <thead class="table-light">
          <tr>
            <th style="width:220px;">Data</th>
            <th>Aviso</th>
            <th style="width:160px;">A√ß√£o</th>
          </tr>
        </thead>

        <tbody>
        {% for dia in dias_validos %}
        <tr>
          <form method="post" action="{{ url_for('admin_aviso') }}">

            <input type="hidden" name="chave_semana" value="{{ semana.chave }}">
            <input type="hidden" name="dia" value="{{ dia }}">

            <!-- DATA -->
            <td class="td-data">
              {{ semana.informacoes[dia].data }} - {{ dia }}
            </td>

            <!-- AVISO -->
            <td>
              <textarea
                name="aviso"
                class="form-control aviso-texto"
                placeholder="Digite o aviso aqui..."
              >{{ semana.informacoes[dia].extra[0] if semana.informacoes[dia].extra else '' }}</textarea>
            </td>

            <!-- A√á√ïES -->
            <td class="acoes">
              <button
                type="submit"
                name="acao"
                value="salvar"
                class="btn btn-success btn-sm"
                onclick="return confirm('Deseja salvar/editar este aviso?')"
              >
                Salvar
              </button>

              {% if semana.informacoes[dia].extra %}
              <button
                type="submit"
                name="acao"
                value="remover"
                class="btn btn-danger btn-sm"
                onclick="return confirm('Deseja remover este aviso?')"
              >
                Remover
              </button>
              {% endif %}
            </td>

          </form>
        </tr>
        {% endfor %}
        </tbody>

      </table>
    </div>

  {% endfor %}

</div>

<script>
  setTimeout(() => {
    document.querySelectorAll('.alert').forEach(el => el.remove());
  }, 4000);
</script>

<script>
setTimeout(() => {
  document.querySelectorAll('.alert').forEach(alert => {
    alert.style.transition = "opacity 0.8s ease";
    alert.style.opacity = "0";

    setTimeout(() => {
      alert.remove();
    }, 800);
  });
}, 3500);
</script>


</body>
</html>
